# 動物大對決 — 數位版設計文件

> 日期：2026-02-14
> 目的：離線單機版，MacBook Pro 14 吋，搭飛機/火車讓小孩玩

## 需求摘要

| 項目 | 決定 |
|------|------|
| 操作者 | 爸爸操作，小孩出指令 |
| 遊戲模式 | vs AI + 本機雙人 |
| 賽制 | 淘汰賽，預設 4/8/16/32，可自訂 |
| 選角方式 | 快速隨機 / 選秀（Snake Draft） / 自選 |
| AI 難度 | 簡單/普通/困難 三段（差異在選角策略） |
| 對戰規則 | 各自擲骰 2d6 + 1 戰定勝負（原版規則） |
| 技術方案 | 本地 Web App（多檔），瀏覽器開 index.html |
| 視覺 | 適度動畫（骰子滾動、卡片翻牌、勝負特效） |
| 佈局 | 左右對稱（格鬥風） |
| 賽程表 | 即時顯示淘汰賽樹 |
| 畫面架構 | 單頁應用，JS 切換畫面 + fade 過渡 |

## 畫面流程

```
主選單 → 賽制設定 → 選角階段 → 對戰循環 → 冠軍畫面
                                    ↑        │
                                    └── 下一場 ┘
```

共 5 個 Screen，單頁切換。

## 各畫面設計

### 1. 主選單

- 遊戲標題
- 兩個按鈕：「vs 電腦」「雙人對戰」
- 選 vs 電腦 → 多一步選 AI 難度（簡單/普通/困難）
- 選雙人 → 直接進賽制設定

### 2. 賽制設定

- 賽制規模：4 / 8 / 16 / 32（按鈕組）
- 選角方式：快速隨機 / 選秀 / 自選（按鈕組）
- 「開始」按鈕

### 3. 選角階段

依選角模式不同：

**快速隨機**：跳過選角，直接顯示分配結果 → 確認後進對戰。

**選秀（Snake Draft）**：
- 系統隨機從 106 隻中抽出 N 隻組成動物池
- 動物池以卡片網格顯示
- Snake draft 順序：A 選 1 → B 選 2 → A 選 2 → B 選 2 → ... 直到選完
- 點擊卡片即選入己方
- vs AI 時，AI 自動選（有短暫延遲模擬思考）
- 畫面下方顯示雙方已選動物 + 輪到誰的提示

**自選**：
- 同選秀佈局，但動物池為全部 106 隻
- 加搜尋列 + 排序功能（依總和/名稱）
- 同樣使用 Snake draft 順序分配

### 4. 對戰畫面（核心）

```
┌──────────────────────────────────────────────┐
│  [迷你淘汰賽樹 ─────────────────────]  第N輪  │
│                                              │
│  ┌─────────┐                  ┌─────────┐    │
│  │  A 動物  │    🎲    🎲     │  B 動物  │    │
│  │  [圖片]  │   A骰   B骰    │  [圖片]  │    │
│  │ 力7 速6  │                 │ 力5 速7  │    │
│  │ 攻8 防4  │   12 vs 10     │ 攻6 防4  │    │
│  │ 智5      │                 │ 智7      │    │
│  │ 技能名   │   A 勝利！      │ 技能名   │    │
│  └─────────┘                  └─────────┘    │
│                                              │
│              [ 擲骰！ ]                       │
└──────────────────────────────────────────────┘
```

對戰流程：
1. 顯示雙方動物卡（翻牌動畫）
2. 點「擲骰」→ 骰子滾動動畫 → 停在結果
3. 骰到 6 → 顯示「天賦觸發！」→ 自動重骰動畫
4. 計算分數 → 分數跳動動畫
5. 勝者卡片發光 + 敗者灰掉
6. 平手 → 顯示「加賽！」→ 自動再骰
7. 短暫延遲後顯示「下一場」按鈕

**淘汰賽樹**：固定在畫面上方，寬度自適應。已完成場次顯示勝者頭像，當前場次高亮。

### 5. 冠軍畫面

- 冠軍動物大圖 + 名稱
- 戰績統計（N 戰全勝）
- 「再來一局」「回主選單」按鈕

## AI 選角策略

| 難度 | 選秀策略 |
|------|---------|
| 簡單 | 隨機挑選 |
| 普通 | 優先選總和前 50% 的動物 |
| 困難 | 貪心演算法：優先選池中總和最高 + 避免屬性分布與已選動物重疊 |

對戰階段三種難度行為一致（骰子是隨機的），難度差異完全體現在選角。

## 計分規則（從 battle-rules.md 移植）

- 雙方各擲 2d6
- 骰面 1-5 對應力量/速度/攻擊/防禦/智慧
- 骰面相同 → 該屬性 ×2
- 骰到 6 → 記錄天賦觸發次數 → 重骰直到 1-5
- 所有骰子定案後：基礎分 = 兩顆骰面對應屬性值之和
- 天賦加分：每次觸發 → 檢查最終骰面命中的加成屬性 → 加總命中的 bonus
- 總分 = 基礎分 + 天賦加分 × 觸發次數
- 平手 → 加賽（再骰一輪）

## 檔案結構

```
game/digital/
├── index.html              ← 進入點
├── css/
│   └── style.css           ← 所有樣式 + 動畫
├── js/
│   ├── app.js              ← 畫面切換 + 主流程
│   ├── battle.js           ← 骰子、計分、天賦觸發
│   ├── draft.js            ← 選秀 + 自選 + 快速隨機
│   ├── ai.js               ← AI 選角策略
│   ├── bracket.js          ← 淘汰賽樹渲染
│   └── animations.js       ← 骰子滾動、卡片翻牌、勝負特效
├── data/
│   └── animals.json        ← 合併全部 wave 的 106 隻動物
└── images/                 ← 複製現有 card/images/ 的 106 張圖片
```

## 資料流

```
animals.json 載入
       ↓
    主選單（選模式 + AI 難度）
       ↓
    賽制設定（規模 + 選角方式）
       ↓
    選角（產出 teamA[], teamB[]）
       ↓
    生成淘汰賽配對 bracket[]
       ↓
    ┌→ 取當前場次 → 對戰 → 記錄勝者 ─┐
    └──────── 還有下一場？ ←──────────┘
       ↓ 否
    冠軍畫面
```

遊戲狀態全放一個 JS 物件，不需要 localStorage。

## 明確排除

- 合作闖關模式（只做動物大對決）
- 共用骰子規則變體
- 3 戰 2 勝制
- 音效
- 手機/平板適配（只針對 14 吋 MacBook Pro）
- 連線對戰
- 存檔/讀檔
